jQuery(function(p){function e(){var e,t=p(this).closest("#yarpp_display_web, #yarpp_display_rss");t.length&&(value=t.find(".use_template").val(),t.find(".yarpp_subbox").hide(),t.find(".template_options_"+value).show(),e=t.find(".yarpp_no_results"),"custom"===value?e.hide():e.show(),e=t.find(".generate_missing_thumbnails"),"builtin"===value?e.hide():e.show(),a.apply(t))}function a(){var e=p(this).closest("#yarpp_display_web, #yarpp_display_rss");e.find(".excerpted").toggle(!("builtin"!==e.find(".use_template").val()||!e.find(".show_excerpt input").prop("checked")))}function t(){p("#yarpp_display_rss .inside").is(":visible")&&(p("#yarpp-rss_display").is(":checked")?(p(".rss_displayed").show(),p("#yarpp_display_rss").each(e)):p(".rss_displayed").hide())}function i(){p("#yarpp_display_api .inside").is(":visible")&&(p("#yarpp-rest_api_display").is(":checked")?p(".yarpp_rest_displayed").show():p(".yarpp_rest_displayed").hide())}function n(){p("#yarpp-rest_api_client_side_caching").is(":checked")?p(".yarpp_rest_browser_cache_displayed").show():p(".yarpp_rest_browser_cache_displayed").hide()}postboxes.add_postbox_toggles(pagenow),p(".use_template").each(e).change(e),p(".show_excerpt, .use_template, #yarpp-rss_display").click(a),p("#yarpp-rss_display, #yarpp_display_rss .handlediv, #yarpp_display_rss-hide").click(t),t(),p("#yarpp-rest_api_display").click(i),i(),p("#yarpp-rest_api_client_side_caching").click(n),n();var s=!1;function r(){var i,e;function n(t){var a;t in i||((a=p("#exclude_"+t)).find(".loading").length||(t in e?e[t]=e[t]+100:e[t]=0,p.ajax({type:"POST",url:ajaxurl,data:{action:"yarpp_display_exclude_terms",taxonomy:t,offset:e[t],_ajax_nonce:p("#yarpp_display_exclude_terms-nonce").val()},beforeSend:function(){a.append(loading)},success:function(e){if(a.find(".loading").remove(),":("==e)return i[t]=!0,void a.append("-");a.append(e)},dataType:"html"})))}!s&&p("#yarpp_pool .inside").is(":visible")&&(s=!0,i={},e={},p(".exclude_terms").each(function(){var a,e=jQuery(this).attr("id");e&&(n(a=e.replace("exclude_","")),p("#exclude_"+a).parent(".yarpp_scroll_wrapper").scroll(function(){var e=p(this),t=e.children("div");e.scrollTop()+e.height()>t.height()-10&&n(a)}))}))}function o(e){p("#tab-link-"+e+" a").click(),p("#contextual-help-link").click()}p("#yarpp_pool .handlediv, #yarpp_pool-hide").click(r),r(),p("#yarpp-optin-learnmore").click(function(){o("optin")}),p("#yarpp-help-cpt").click(function(){o("dev")}),"#help-optin"==location.hash&&setTimeout(function(){o("optin")}),p(".yarpp_help[data-help]").hover(function(){var e=p(this),t={content:"<p>"+e.attr("data-help")+"</p>",position:{edge:isRtl?"right":"left",align:"center",of:e},document:{body:e}},a=e.pointer(t).pointer("open");e.closest(".yarpp_form_row, p").mouseleave(function(){a.pointer("close")})}),p(".yarpp_template_button[data-help]").hover(function(){var e=p(this),t="<p>"+e.attr("data-help")+"</p>",a=e.pointer({content:t,position:{edge:"bottom",of:e},document:{body:e}}).pointer("open");e.mouseleave(function(){a.pointer("close")}),p(".yarpp_copy_templates_button").on("click",function(){const e=p(this),t=e.siblings(".spinner");e.addClass("yarpp-disabled"),t.addClass("is-active"),window.location=window.location+(window.location.search.length?"&":"?")+"action=copy_templates&_ajax_nonce="+p("#yarpp_copy_templates-nonce").val()})}),p(".yarpp_spin_on_click").on("click",function(){const e=p(this),t=e.siblings(".spinner");e.addClass("yarpp-disabled"),t.addClass("is-active")});const c=document.getElementById("yarpp-preview-show-code"),d=document.getElementById("yarpp-display-code-preview");function l(e=!1){"none"===d.style.display||e?(d.style.display="block",c.innerText=yarpp_messages.hide_code):(d.style.display="none",c.innerText=yarpp_messages.show_code)}c&&c.addEventListener("click",()=>l());const _=document.querySelector("#yarpp-display-html-preview .yarpp-preview__iframe__container");if(_){let a;function u(e){var t=e.x-a;a=e.x,_.style.width=parseInt(getComputedStyle(_,"").width)+t+"px",D()}_.addEventListener("mousedown",function(e){e.layerX-e.offsetX<50&&(a=e.x,document.addEventListener("mousemove",u,!1))}),document.addEventListener("mouseup",function(){document.removeEventListener("mousemove",u,!1)})}let y={};function h(e,t,a="value"){t=t.target[a];y[e]="checked"===a?t?1:0:t,N()}const m=document.querySelector("#limit[name=limit]");m&&m.addEventListener("blur",e=>h("limit",e));const v=document.querySelector("#yarpp-promote_yarpp[name=promote_yarpp]");v&&v.addEventListener("change",e=>h("promote_yarpp",e,"checked"));const f=document.querySelector("#order[name=order]");f&&f.addEventListener("change",e=>h("order",e));const b=document.querySelector("#template_file[name=template_file]");b&&b.addEventListener("change",e=>h("template",e));const g=document.querySelector("#thumbnail_size_display[name=thumbnail_size_display]");g&&g.addEventListener("change",e=>h("size",e));const w=document.querySelector("#custom_theme_thumbnail_size_display[name=custom_theme_thumbnail_size_display]");w&&w.addEventListener("change",e=>h("size",e));const x=document.querySelector("#thumbnails_heading[name=thumbnails_heading]");x&&x.addEventListener("blur",e=>h("thumbnails_heading",e));const k=document.querySelector("#thumbnails_default[name=thumbnails_default]");k&&k.addEventListener("blur",e=>h("thumbnails_default",e));const S=document.querySelector("#before_related[name=before_related]");S&&S.addEventListener("blur",e=>h("before_related",e));const E=document.querySelector("#after_related[name=after_related]");E&&E.addEventListener("blur",e=>h("after_related",e));const L=document.querySelector("#before_title[name=before_title]");L&&L.addEventListener("blur",e=>h("before_title",e));const q=document.querySelector("#after_title[name=after_title]");q&&q.addEventListener("blur",e=>h("after_title",e));const C=document.querySelector("#yarpp-show_excerpt[name=show_excerpt]");C&&C.addEventListener("change",e=>h("show_excerpt",e,"checked"));const T=document.querySelector("#excerpt_length[name=excerpt_length]");T&&T.addEventListener("blur",e=>h("excerpt_length",e));const j=document.querySelector("#before_post[name=before_post]");j&&j.addEventListener("blur",e=>h("before_post",e));const z=document.querySelector("#after_post[name=after_post]");function O(e){_.style.width=e+"px",D()}function D(){var e=document.querySelector(".yarpp-preview__iframe__backdrop");e&&(document.querySelector("#yarpp-preview__show-preview-width__value").innerText=e.offsetWidth-20+"px")}z&&z.addEventListener("blur",e=>h("after_post",e)),window.addEventListener("resize",D);const P=document.querySelector("#yarpp-preview-mobile");P&&P.addEventListener("click",e=>O(320));const B=document.querySelector("#yarpp-preview-tablet");B&&B.addEventListener("click",e=>O(768));const I=document.querySelector("#yarpp-preview-desktop");function N(e=null){c.setAttribute("disabled","disabled");var n=p("#yarpp-display-html-preview .yarpp-preview__iframe__container"),s=p("#yarpp-display-code-preview");const r=document.querySelector("#yarpp-display-html-preview div.yarpp-preview__iframe__backdrop");D(),e&&("custom"===e?(y.template=b.value,w.value&&(y.size=w.value)):y.template=e,"thumbnails"===e&&g.value&&(y.size=g.value)),console.log("Rendering Template Preview: ",y),p.ajax({type:"POST",url:ajaxurl,data:{action:"yarpp_display_preview",_ajax_nonce:p("#yarpp_display_preview-nonce").val(),...y},beforeSend:function(){n.html(loading)},success:function(e){const a=JSON.parse(e),i=document.createElement("style");i.appendChild(document.createTextNode(a.styles));const t=document.createElement("iframe");t.width="100%",t.height="100%",t.style="overflow: hidden; user-select: none; outline: 0; background-color: white;",n.html(t),n.prepend(r),t.onload=e=>{const t=e.target.contentWindow.document;t.getElementsByTagName("head")[0].appendChild(i),t.body.innerHTML=a.html,t.body.style="overflow:hidden;"},"codeEditor"in wp?(l(!0),e={...wp.codeEditor.defaultSettings,type:"text/html",codemirror:{...wp.codeEditor.defaultSettings.codemirror,indentUnit:2,tabSize:2,readOnly:!0}},s.html('<textarea id="yarpp-preview-code-textarea">'+a.code+"</textarea>"),wp.codeEditor.initialize(document.getElementById("yarpp-preview-code-textarea"),e),l()):s.html("<pre><code>"+a.code+"</code></pre>"),c.removeAttribute("disabled")},dataType:"html"})}function A(){var e=p(this).find("option:selected"),t=e.closest(".yarpp_form_row");e.attr("data-url")?t.find(".template_author_wrap").toggle(!!e.attr("data-author")).find("span").empty().append("<a>"+e.attr("data-author")+"</a>").attr("href",e.attr("data-url")):t.find(".template_author_wrap").toggle(!!e.attr("data-author")).find("span").text(e.attr("data-author")),t.find(".template_description_wrap").toggle(!!e.attr("data-description")).find("span").text(e.attr("data-description")),t.find(".template_file_wrap").toggle(!!e.attr("data-basename")).find("span").text(e.attr("data-basename"))}I&&I.addEventListener("click",e=>O(1200)),N(),p(".yarpp_template_button:not(.disabled)").click(function(){var e=p(this).attr("data-value");p(this).siblings("input").val(e).change(),p(this).siblings().removeClass("active"),p(this).addClass("active"),p(this).parents("#yarpp_display_web").length&&N(e)}),p("#template_file, #rss_template_file").each(A).change(A);var H=!1;function Q(){var t;p("#optin_data_frame").is(":visible")&&!H&&(H=!0,t=p("#optin_data_frame"),p.ajax({type:"POST",url:ajaxurl,data:{action:"yarpp_optin_data",_ajax_nonce:p("#yarpp_optin_data-nonce").val()},beforeSend:function(){t.html(loading)},success:function(e){t.html("<pre>"+e+"</pre>")},dataType:"html"}))}function R(){setTimeout(Q,0)}function W(){var e=p(".yarpp_form_post_types").is(":has(input[type=checkbox]:checked)");p("#yarpp-auto_display_archive").attr("disabled",!e),e||p("#yarpp-auto_display_archive").prop("checked",!1)}function X(e,t){e?(p(".yarpp_form_post_types #yarpp_post_type_"+t).prop("disabled",!1),p(".yarpp_form_post_types #yarpp_post_type_"+t).siblings().hide()):(p(".yarpp_form_post_types #yarpp_post_type_"+t).prop("disabled",!0),p(".yarpp_form_post_types #yarpp_post_type_"+t).siblings().show())}p("#yarpp-optin-learnmore, a[aria-controls=tab-panel-optin]").bind("click focus",R),R(),p(".sync_no_results, .sync_rss_no_results").change(function(){var e=p(this).find("input").attr("value");p(this).hasClass("sync_no_results")&&p(".sync_no_results input").attr("value",e),p(this).hasClass("sync_rss_no_results")&&p(".sync_rss_no_results input").attr("value",e)}),p(".yarpp_form_post_types input[type=checkbox]").change(W),W(),p("#yarpp_fulltext_expand").click(function(e){e.preventDefault();e=p("#yarpp_fulltext_details");e.slideToggle(),e.hasClass("hidden")?(e.removeClass("hidden"),p(this).text("Hide Details [-]")):(e.addClass("hidden"),p(this).text("Show Details [+]"))}),p(".include_post_type input[type=checkbox]").change(function(e){var t=p(this).attr("data-post-type");p("#yarpp-same_post_type").is(":checked")?X(p(this).is(":checked"),t):p(".yarpp_form_post_types #yarpp_post_type_"+t).prop("disabled",!1)}),p("#yarpp-same_post_type").change(function(e){p(this).is(":checked")?p(".include_post_type input[type=checkbox]").each(function(){var e=p(this).attr("data-post-type");X(p(this).is(":checked"),e)}):(p(".yarpp_form_post_types input[type=checkbox]").prop("disabled",!1),p(".yarpp_form_post_types input[type=checkbox]").siblings().hide())});var J=p('\t\t\t<div id="shareaholic-deactivate-dialog" class="shareaholic-deactivate-dialog" data-remodal-id="">\t\t\t\t<div class="shareaholic-deactivate-header" style="background-image: url('+yarpp_messages.logo+"); background-color: "+yarpp_messages.bgcolor+';"><div class="shareaholic-deactivate-text"><h2>'+yarpp_messages.model_title+'</h2></div></div>\t\t\t\t<div class="shareaholic-deactivate-body">\t\t\t\t\t<div class="shareaholic-deactivate-body-foreword">'+yarpp_messages.alert_message+'</div>\t\t\t\t\t<div class="shareaholic-deactivate-dialog-footer">                    <input type="submit" class="button confirm button-secondary" id="yarpp-clear-cache-submit" value="Delete"/>\t\t\t\t\t\t<button data-remodal-action="cancel" class="button button-secondary">Cancel</button>\t\t\t\t\t\t</div>\t\t\t\t</div>\t\t\t</div>\t\t')[0];p("#yarpp-clear-cache").click(function(){p(J).remodal({hashTracking:!1,closeOnOutsideClick:!1}).open(),event.preventDefault()}),p(document.body).on("click","#yarpp-clear-cache-submit",function(){p(J).remodal().close();var a="#yarpp-clear-cache",i="#display_notices",n="notice notice-error is-dismissible";p(a).prop("disabled",!0),p.ajax({type:"POST",url:ajaxurl,data:{action:"yarpp_clear_cache",_ajax_nonce:p("#clear_cache-nonce").val()},beforeSend:function(){p(a).siblings(".spinner").addClass("is-active")},success:function(e){var t;p(a).siblings(".spinner").removeClass("is-active"),p(i).show(),"success"==e?(t=yarpp_messages.success,n="notice notice-success is-dismissible",p(a).prop("disabled",!1)):t="forbidden"==e?yarpp_messages.forbidden:"nonce_fail"==e?yarpp_messages.nonce_fail:yarpp_messages.error,p(i).addClass(n),p(i).html("<p>"+t+"</p>")},error:function(e){p(i).show(),p(i).addClass(n),p(a).siblings(".spinner").removeClass("is-active"),p(i).html("<p>"+yarpp_messages.error+"</p>")}}),p(i).delay(5e3).fadeOut(1e3)})});